<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>シンプル投資比較ツール - 銀行預金vs投資利率比較（無料）</title>
    <meta name="description" content="毎月の積立額と利率を入力するだけで、銀行預金（0%）と投資利率の30年間の資産推移を比較できる無料シミュレーター。">
    
    <!-- OGP Meta Tags -->
    <meta property="og:title" content="シンプル投資比較ツール - 銀行預金vs投資利率比較（無料）">
    <meta property="og:description" content="毎月の積立額と利率を入力するだけで、銀行預金と投資利率の30年間の資産推移を比較。無料でお使いいただけるシミュレーターです。">
    <meta property="og:image" content="https://www.coommu.com/wp-content/uploads/2025/08/toushi1200x630.webp">
    <meta property="og:url" content="https://www.coommu.com/wp-content/uploads/simple-investment.html">
    <meta property="og:type" content="website">
    <meta property="og:site_name" content="Coommu">
    
    <!-- Twitter Card -->
    <meta name="twitter:card" content="summary_large_image">
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+JP:wght@400;500;600&family=Poppins:wght@400;500;600&display=swap" rel="stylesheet">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/3.9.1/chart.min.js"></script>
    <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-6508744207193174"
         crossorigin="anonymous"></script>
    
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Noto Sans JP', 'Poppins', -apple-system, BlinkMacSystemFont, sans-serif;
            background: #f8f7f5;
            background-image: 
                linear-gradient(45deg, rgba(255,255,255,0.4) 25%, transparent 25%),
                linear-gradient(-45deg, rgba(255,255,255,0.4) 25%, transparent 25%),
                linear-gradient(45deg, transparent 75%, rgba(255,255,255,0.4) 75%),
                linear-gradient(-45deg, transparent 75%, rgba(255,255,255,0.4) 75%);
            background-size: 30px 30px;
            background-position: 0 0, 0 15px, 15px -15px, -15px 0px;
            color: #4a4a4a;
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            align-items: center;
            padding: 30px 20px;
            line-height: 1.6;
        }

        .header {
            text-align: center;
            margin: 40px 0 50px 0;
        }

        h1 {
            font-size: 2.8em;
            font-weight: 500;
            color: #5d5852;
            margin-bottom: 15px;
            font-family: 'Noto Sans JP', sans-serif;
            letter-spacing: -0.02em;
        }

        .subtitle {
            font-size: 1.1em;
            color: #7a736b;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 12px;
            font-weight: 400;
        }

        .main-area {
            display: flex;
            flex-direction: column;
            align-items: center;
            max-width: 900px;
            width: 100%;
            background: rgba(255, 255, 255, 0.9);
            backdrop-filter: blur(5px);
            border-radius: 24px;
            padding: 50px 40px;
            border: 1px solid rgba(220, 218, 215, 0.3);
            box-shadow: 0 8px 32px rgba(160, 155, 145, 0.08);
        }

        .input-container {
            width: 100%;
            max-width: 600px;
            margin-bottom: 40px;
        }

        .input-group {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 20px;
        }

        .input-row {
            display: flex;
            gap: 20px;
            width: 100%;
            justify-content: center;
            flex-wrap: wrap;
        }

        .input-item {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 10px;
            flex: 1;
            min-width: 200px;
        }

        .input-item .input-field {
            width: 100%;
        }

        .calculate-btn {
            background: #8b8074;
            color: white;
            border: 1px solid transparent;
            padding: 16px 32px;
            border-radius: 16px;
            font-size: 1.1em;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            box-shadow: 0 2px 8px rgba(139, 128, 116, 0.15);
            display: inline-flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
            font-family: 'Noto Sans JP', sans-serif;
            width: 100%;
            max-width: 300px;
        }

        .calculate-btn:hover {
            background: #7a6f63;
            transform: translateY(-1px);
            box-shadow: 0 4px 16px rgba(139, 128, 116, 0.25);
        }

        .calculate-btn:disabled {
            background: #d4cfc7;
            color: #9b9388;
            cursor: not-allowed;
            transform: none;
            box-shadow: none;
        }

        .input-label {
            font-size: 1.3em;
            font-weight: 600;
            color: #5d5852;
            text-align: center;
        }

        .input-field {
            width: 100%;
            padding: 18px 24px;
            font-size: 1.4em;
            border: 2px solid #d4cfc7;
            border-radius: 16px;
            background: rgba(255, 255, 255, 0.8);
            color: #4a4a4a;
            text-align: center;
            font-weight: 500;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            font-family: 'Noto Sans JP', sans-serif;
        }

        .input-field:focus {
            outline: none;
            border-color: #8b8074;
            background: rgba(255, 255, 255, 0.95);
            box-shadow: 0 4px 20px rgba(139, 128, 116, 0.15);
            transform: translateY(-1px);
        }

        .results {
            width: 100%;
            display: none;
        }

        .chart-container {
            position: relative;
            width: 100%;
            height: 400px;
            margin-bottom: 30px;
            background: rgba(255, 255, 255, 0.7);
            border-radius: 16px;
            padding: 20px;
            border: 1px solid #e8e3de;
        }

        .summary-cards {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-top: 20px;
        }

        .summary-card {
            background: rgba(255, 255, 255, 0.8);
            border: 1px solid #e8e3de;
            border-radius: 16px;
            padding: 24px;
            text-align: center;
            transition: all 0.3s ease;
        }

        .summary-card:hover {
            background: rgba(255, 255, 255, 0.95);
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(160, 155, 145, 0.1);
        }

        .card-title {
            font-size: 1.1em;
            font-weight: 600;
            color: #5d5852;
            margin-bottom: 10px;
        }

        .card-amount {
            font-size: 1.8em;
            font-weight: 600;
            margin-bottom: 8px;
        }

        .card-detail {
            font-size: 0.9em;
            color: #7a736b;
        }

        .bank-card .card-amount { color: #dc3545; }
        .investment-card .card-amount { color: #198754; }
        .difference-card .card-amount.positive { color: #198754; }
        .difference-card .card-amount.negative { color: #dc3545; }
        .difference-card .card-amount.neutral { color: #6c757d; }

        .preset-buttons {
            width: 100%;
            margin-top: 30px;
            padding: 30px 0;
            border-top: 1px solid #e8e3de;
        }

        .preset-buttons-title {
            text-align: center;
            font-size: 1.2em;
            font-weight: 600;
            color: #5d5852;
            margin-bottom: 20px;
        }

        .preset-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 12px;
            max-width: 800px;
            margin: 0 auto;
        }

        .preset-btn {
            background: rgba(255, 255, 255, 0.8);
            border: 1px solid #d4cfc7;
            border-radius: 12px;
            padding: 14px 16px;
            font-size: 0.95em;
            font-weight: 500;
            color: #5d5852;
            cursor: pointer;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            font-family: 'Noto Sans JP', sans-serif;
            text-align: center;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }

        .preset-btn:hover {
            background: rgba(255, 255, 255, 0.95);
            border-color: #8b8074;
            transform: translateY(-1px);
            box-shadow: 0 2px 8px rgba(139, 128, 116, 0.15);
        }

        .preset-btn:active {
            transform: translateY(0);
            box-shadow: 0 1px 4px rgba(139, 128, 116, 0.2);
        }

        .preset-btn.selected {
            background: #8b8074;
            color: white;
            border-color: #8b8074;
            box-shadow: 0 2px 8px rgba(139, 128, 116, 0.3);
        }

        .preset-btn.selected:hover {
            background: #7a6f63;
            border-color: #7a6f63;
        }

        .period-info {
            text-align: center;
            margin: 20px 0;
            padding: 12px 20px;
            background: rgba(255, 255, 255, 0.6);
            border-radius: 12px;
            color: #7a736b;
            font-size: 1.1em;
            font-weight: 500;
        }

        .year-adjustment {
            width: 100%;
            margin-top: 30px;
            padding: 30px 0;
            border-top: 1px solid #e8e3de;
        }

        .year-adjustment-title {
            text-align: center;
            font-size: 1.2em;
            font-weight: 600;
            color: #5d5852;
            margin-bottom: 20px;
        }

        .year-input-container {
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 15px;
            flex-wrap: wrap;
        }

        .year-input-label {
            font-size: 1.1em;
            font-weight: 500;
            color: #5d5852;
        }

        .year-input-field {
            width: 120px;
            padding: 12px 16px;
            font-size: 1.2em;
            border: 2px solid #d4cfc7;
            border-radius: 12px;
            background: rgba(255, 255, 255, 0.8);
            color: #4a4a4a;
            text-align: center;
            font-weight: 500;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            font-family: 'Noto Sans JP', sans-serif;
        }

        .year-input-field:focus {
            outline: none;
            border-color: #8b8074;
            background: rgba(255, 255, 255, 0.95);
            box-shadow: 0 4px 20px rgba(139, 128, 116, 0.15);
            transform: translateY(-1px);
        }

        @media (max-width: 600px) {
            body {
                padding: 20px 15px;
            }
            
            .header {
                margin: 30px 0 40px 0;
            }

            h1 {
                font-size: 2.2em;
            }
            
            .main-area {
                padding: 35px 25px;
            }

            .chart-container {
                height: 300px;
                padding: 15px;
            }

            .summary-cards {
                grid-template-columns: 1fr;
            }

            .input-field {
                font-size: 1.2em;
                padding: 16px 20px;
            }

            .input-row {
                flex-direction: column;
                gap: 15px;
            }

            .input-item {
                min-width: auto;
            }

            .preset-grid {
                grid-template-columns: repeat(auto-fit, minmax(160px, 1fr));
                gap: 10px;
            }

            .preset-btn {
                font-size: 0.9em;
                padding: 12px 14px;
            }
        }
    </style>
</head>
<body>
    <div class="header">
        <h1>積立投資シミュレーター｜毎月の金額と利率で30年後をグラフ比較</h1>
        <div class="subtitle">
            <span>銀行預金（0%）と投資利率で、積立の将来資産を年複利で可視化できます。</span>
        </div>
    </div>

    <div class="main-area">
        
        <div class="input-container">
            <div class="input-group">
                <div class="input-row">
                    <div class="input-item">
                        <label class="input-label" for="monthlyAmount">毎月の積立額（円）</label>
                        <input type="number" id="monthlyAmount" class="input-field" placeholder="例: 30000" min="1" max="1000000" step="1" aria-label="毎月の積立額を円単位で入力">
                    </div>
                    <div class="input-item">
                        <label class="input-label" for="interestRate">投資利率（%）</label>
                        <input type="number" id="interestRate" class="input-field" placeholder="例: 5.0" min="-50" max="50" step="0.1" aria-label="年間投資利率をパーセント単位で入力（マイナス値も可能）">
                    </div>
                </div>
                
                <button class="calculate-btn" id="calculateBtn" disabled aria-label="投資比較を実行">
                    比較実行
                </button>
            </div>
        </div>

        <div class="results" id="results">
            <div class="chart-container">
                <canvas id="investmentChart" role="img" aria-label="投資比較結果のグラフ"></canvas>
            </div>
            
            <div class="summary-cards">
                <div class="summary-card bank-card">
                    <div class="card-title">銀行預金（利率0%）</div>
                    <div class="card-amount" id="bankAmount">¥0</div>
                    <div class="card-detail">元本のみ</div>
                </div>
                
                <div class="summary-card investment-card">
                    <div class="card-title" id="investmentTitle">投資</div>
                    <div class="card-amount" id="investmentAmount">¥0</div>
                    <div class="card-detail" id="investmentDetail">年複利</div>
                </div>
                
                <div class="summary-card difference-card">
                    <div class="card-title">差額（投資 - 銀行）</div>
                    <div class="card-amount" id="differenceAmount">¥0</div>
                    <div class="card-detail" id="differenceDetail">利益または損失</div>
                </div>
            </div>
            
            <div class="preset-buttons">
                <div class="preset-buttons-title">プリセット利率</div>
                <div class="preset-grid">
                    <button class="preset-btn" data-rate="0.2">銀行 定期預金</button>
                    <button class="preset-btn" data-rate="1.0">学資保険</button>
                    <button class="preset-btn" data-rate="-100.0">生命保険（掛け捨て）</button>
                    <button class="preset-btn" data-rate="4.0">投資信託（バランス型）</button>
                    <button class="preset-btn" data-rate="7.0">米国株インデックス</button>
                    <button class="preset-btn" data-rate="5.0">パチスロ（設定6）</button>
                    <button class="preset-btn" data-rate="-0.5">住宅ローン（変動）</button>
                    <button class="preset-btn" data-rate="-18.0">消費者金融</button>
                    <button class="preset-btn" data-rate="-15.0">クレジットカードリボ払い</button>
                    <button class="preset-btn" data-rate="-10.0">パチンコ</button>
                    <button class="preset-btn" data-rate="0.6">国債</button>
                    <button class="preset-btn" data-rate="-25.0">競馬（JRA）</button>
                </div>
            </div>
            
            <div class="year-adjustment">
                <div class="year-adjustment-title">投資期間調整</div>
                <div class="year-input-container">
                    <label class="year-input-label" for="yearsInput">投資期間：</label>
                    <input type="number" id="yearsInput" class="year-input-field" value="30" min="1" max="100" step="1" aria-label="投資期間を年単位で入力">
                    <span class="year-input-label">年</span>
                </div>
            </div>
            
            <!-- AdSense広告 -->
            <div id="adContainer" style="margin: 30px 0; padding: 20px; text-align: center; min-width: 300px; width: 100%; min-height: 280px;">
                <!-- 広告はJavaScriptで動的に挿入 -->
            </div>
        </div>
    </div>

    <script>
        let chart = null;
        const monthlyInput = document.getElementById('monthlyAmount');
        const interestRateInput = document.getElementById('interestRate');
        const calculateBtn = document.getElementById('calculateBtn');
        const results = document.getElementById('results');
        const bankAmountEl = document.getElementById('bankAmount');
        const investmentAmountEl = document.getElementById('investmentAmount');
        const investmentTitleEl = document.getElementById('investmentTitle');
        const investmentDetailEl = document.getElementById('investmentDetail');
        const differenceAmountEl = document.getElementById('differenceAmount');
        const differenceDetailEl = document.getElementById('differenceDetail');
        const yearsInput = document.getElementById('yearsInput');

        function calculateInvestments(monthlyAmount, interestRate, years = 30) {
            const bankData = [];
            const investmentData = [];
            const labels = [];

            // 年間積立額を事前計算
            const annualAmount = monthlyAmount * 12;
            
            // 利率を小数に変換
            const rate = interestRate / 100;

            for (let year = 1; year <= years; year++) {
                labels.push(`${year}年`);
                
                // 銀行預金（利率0%）
                const bankTotal = annualAmount * year;
                bankData.push(bankTotal);
                
                // 投資（年1回複利計算）
                // 各年末に積立額を追加してから利率を適用
                let investmentTotal = 0;
                for (let y = 1; y <= year; y++) {
                    // y年目の積立額を追加
                    investmentTotal += annualAmount;
                    // その後に利率を適用（年末）
                    investmentTotal = investmentTotal * (1 + rate);
                }
                
                // マイナス利率で0円を下回る場合は0円に補正
                if (investmentTotal < 0) {
                    investmentTotal = 0;
                }
                
                investmentData.push(Math.round(investmentTotal));
            }

            return {
                labels,
                bankData,
                investmentData,
                finalBank: bankData[bankData.length - 1],
                finalInvestment: investmentData[investmentData.length - 1],
                interestRate
            };
        }

        function formatCurrency(amount) {
            return '¥' + amount.toLocaleString('ja-JP');
        }

        function updateChart(monthlyAmount, interestRate, years = null) {
            const investmentYears = years || parseInt(yearsInput.value) || 30;
            const data = calculateInvestments(monthlyAmount, interestRate, investmentYears);
            
            // サマリーカードの更新
            bankAmountEl.textContent = formatCurrency(data.finalBank);
            investmentAmountEl.textContent = formatCurrency(data.finalInvestment);
            investmentTitleEl.textContent = `投資（利率${interestRate}%）`;
            investmentDetailEl.textContent = `年${interestRate}%複利`;
            
            // 差額の計算と表示
            const difference = data.finalInvestment - data.finalBank;
            const sign = difference > 0 ? '+' : difference < 0 ? '-' : '';
            differenceAmountEl.textContent = `${sign}${formatCurrency(Math.abs(difference))}`;
            
            // 差額の色を設定
            differenceAmountEl.classList.remove('positive', 'negative', 'neutral');
            if (difference > 0) {
                differenceAmountEl.classList.add('positive');
                differenceDetailEl.textContent = '利益';
            } else if (difference < 0) {
                differenceAmountEl.classList.add('negative');
                differenceDetailEl.textContent = '損失';
            } else {
                differenceAmountEl.classList.add('neutral');
                differenceDetailEl.textContent = '差額なし';
            }

            const ctx = document.getElementById('investmentChart').getContext('2d');
            
            if (chart) {
                chart.destroy();
            }

            chart = new Chart(ctx, {
                type: 'line',
                data: {
                    labels: data.labels,
                    datasets: [
                        {
                            label: '銀行預金（0%）',
                            data: data.bankData,
                            borderColor: '#dc3545',
                            backgroundColor: 'rgba(220, 53, 69, 0.1)',
                            borderWidth: 3,
                            fill: false,
                            tension: 0.1
                        },
                        {
                            label: `投資（${interestRate}%）`,
                            data: data.investmentData,
                            borderColor: '#198754',
                            backgroundColor: 'rgba(25, 135, 84, 0.1)',
                            borderWidth: 3,
                            fill: false,
                            tension: 0.1
                        }
                    ]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    interaction: {
                        intersect: false,
                        mode: 'index'
                    },
                    plugins: {
                        legend: {
                            display: true,
                            position: 'top',
                            labels: {
                                font: {
                                    family: 'Noto Sans JP',
                                    size: 14
                                },
                                usePointStyle: true,
                                padding: 20
                            }
                        },
                        tooltip: {
                            backgroundColor: 'rgba(255, 255, 255, 0.95)',
                            titleColor: '#4a4a4a',
                            bodyColor: '#4a4a4a',
                            borderColor: '#d4cfc7',
                            borderWidth: 1,
                            cornerRadius: 8,
                            titleFont: {
                                family: 'Noto Sans JP',
                                size: 14
                            },
                            bodyFont: {
                                family: 'Noto Sans JP',
                                size: 13
                            },
                            callbacks: {
                                label: function(context) {
                                    return context.dataset.label + ': ' + formatCurrency(context.parsed.y);
                                }
                            }
                        }
                    },
                    scales: {
                        x: {
                            display: true,
                            title: {
                                display: true,
                                text: '年数',
                                font: {
                                    family: 'Noto Sans JP',
                                    size: 14
                                }
                            },
                            ticks: {
                                font: {
                                    family: 'Noto Sans JP'
                                },
                                maxTicksLimit: 10
                            }
                        },
                        y: {
                            display: true,
                            title: {
                                display: true,
                                text: '資産額（円）',
                                font: {
                                    family: 'Noto Sans JP',
                                    size: 14
                                }
                            },
                            ticks: {
                                font: {
                                    family: 'Noto Sans JP'
                                },
                                callback: function(value) {
                                    return (value / 10000).toFixed(0) + '万円';
                                }
                            }
                        }
                    }
                }
            });

            results.style.display = 'block';
            
            // AdSense広告の動的挿入と初期化（結果表示後）
            setTimeout(() => {
                try {
                    const adContainer = document.getElementById('adContainer');
                    
                    // 広告要素を動的に作成・挿入
                    const adElement = document.createElement('ins');
                    adElement.className = 'adsbygoogle';
                    adElement.style.display = 'block';
                    adElement.style.width = '100%';
                    adElement.style.minHeight = '250px';
                    adElement.setAttribute('data-ad-client', 'ca-pub-6508744207193174');
                    adElement.setAttribute('data-ad-slot', '1780206636');
                    adElement.setAttribute('data-ad-format', 'auto');
                    adElement.setAttribute('data-full-width-responsive', 'true');
                    
                    // コンテナに追加
                    adContainer.innerHTML = '';
                    adContainer.appendChild(adElement);
                    
                    // 広告を初期化
                    (adsbygoogle = window.adsbygoogle || []).push({});
                    console.log('AdSense dynamically inserted and initialized - container width:', adContainer.offsetWidth);
                } catch(e) {
                    console.error('AdSense dynamic insertion error:', e);
                }
            }, 1000);
        }

        let hasShownResults = false;
        let debounceTimeout = null;

        // 両方の入力値をチェックする関数
        function checkInputs() {
            const amount = parseFloat(monthlyInput.value);
            const rate = parseFloat(interestRateInput.value);
            return amount && amount >= 1 && !isNaN(rate) && rate !== null;
        }

        // デバウンス処理
        function debounce(func, delay) {
            return function(...args) {
                clearTimeout(debounceTimeout);
                debounceTimeout = setTimeout(() => func.apply(this, args), delay);
            };
        }

        // 入力値の変更でボタンの有効/無効を制御、または結果表示済みならリアルタイム更新
        function handleInputChange() {
            const amount = parseFloat(monthlyInput.value);
            const rate = parseFloat(interestRateInput.value);
            
            if (checkInputs()) {
                calculateBtn.disabled = false;
                // 一度結果を表示したらリアルタイム更新（デバウンス処理）
                if (hasShownResults) {
                    const years = parseInt(yearsInput.value) || 30;
                    debouncedUpdate(amount, rate, years);
                }
            } else {
                calculateBtn.disabled = true;
                // 入力値が無効になったら結果を非表示
                if (hasShownResults) {
                    results.style.display = 'none';
                }
            }
        }
        
        // 利率入力欄の変更を監視（手動入力時に選択状態をクリア）
        function handleInterestRateChange() {
            // プリセットボタンからの入力でない場合、選択状態をクリア
            const currentRate = parseFloat(interestRateInput.value);
            const presetButtons = document.querySelectorAll('.preset-btn');
            let foundMatch = false;
            
            presetButtons.forEach(btn => {
                const btnRate = parseFloat(btn.getAttribute('data-rate'));
                if (Math.abs(btnRate - currentRate) < 0.01) { // 小数点誤差を考慮
                    foundMatch = true;
                }
            });
            
            if (!foundMatch) {
                clearPresetSelection();
            }
            
            handleInputChange();
        }

        // デバウンス処理を適用した更新関数
        const debouncedUpdate = debounce((amount, rate, years) => {
            updateChart(amount, rate, years);
        }, 500);

        monthlyInput.addEventListener('input', handleInputChange);
        interestRateInput.addEventListener('input', handleInterestRateChange);

        // プリセットボタンの処理
        function setupPresetButtons() {
            const presetButtons = document.querySelectorAll('.preset-btn');
            presetButtons.forEach(button => {
                button.addEventListener('click', function() {
                    const rate = this.getAttribute('data-rate');
                    interestRateInput.value = rate;
                    
                    // 他のボタンの選択状態を解除
                    presetButtons.forEach(btn => btn.classList.remove('selected'));
                    
                    // 現在のボタンを選択状態にする
                    this.classList.add('selected');
                    
                    // 金額が入力されていれば自動で更新
                    const amount = parseFloat(monthlyInput.value);
                    if (amount && amount >= 1) {
                        if (hasShownResults) {
                            const years = parseInt(yearsInput.value) || 30;
                            updateChart(amount, parseFloat(rate), years);
                        } else {
                            calculateBtn.disabled = false;
                        }
                    }
                });
            });
        }
        
        // 利率入力欄の変更時に選択状態をリセットする関数
        function clearPresetSelection() {
            const presetButtons = document.querySelectorAll('.preset-btn');
            presetButtons.forEach(btn => btn.classList.remove('selected'));
        }

        // ボタンクリックで比較実行
        calculateBtn.addEventListener('click', function() {
            const amount = parseFloat(monthlyInput.value);
            const rate = parseFloat(interestRateInput.value);
            const years = parseInt(yearsInput.value) || 30;
            if (checkInputs()) {
                hasShownResults = true;
                updateChart(amount, rate, years);
                // ボタンを非表示にする
                calculateBtn.style.display = 'none';
            }
        });

        // Enterキーでも比較実行
        function handleEnterKey(e) {
            if (e.key === 'Enter') {
                const amount = parseFloat(monthlyInput.value);
                const rate = parseFloat(interestRateInput.value);
                const years = parseInt(yearsInput.value) || 30;
                if (checkInputs() && !calculateBtn.disabled) {
                    hasShownResults = true;
                    updateChart(amount, rate, years);
                    // ボタンを非表示にする
                    calculateBtn.style.display = 'none';
                }
            }
        }

        monthlyInput.addEventListener('keypress', handleEnterKey);
        interestRateInput.addEventListener('keypress', handleEnterKey);
        yearsInput.addEventListener('keypress', handleEnterKey);
        
        // 年数入力の変更でリアルタイム更新
        yearsInput.addEventListener('input', function() {
            if (hasShownResults) {
                const amount = parseFloat(monthlyInput.value);
                const rate = parseFloat(interestRateInput.value);
                const years = parseInt(yearsInput.value) || 30;
                if (amount && amount >= 1 && !isNaN(rate)) {
                    debouncedUpdate(amount, rate, years);
                }
            }
        });

        // 初期表示はシンプルに（結果非表示）
        monthlyInput.value = '';
        interestRateInput.value = '';

        document.addEventListener('DOMContentLoaded', function() {
            setupPresetButtons();
            console.log('シンプル投資比較ツール準備完了');
        });
    </script>

    <footer style="margin-top: 120px; font-size: 13px; color: #9c948b; text-align: center; max-width: 650px; width: 100%; margin-left: auto; margin-right: auto; line-height: 1.6;">
        この積立投資シミュレーターでは、毎月の積立額と利率を入力するだけで、銀行預金（利率０％）と投資利率による30年間の資産推移を無料でグラフ比較できます。<br>
        利率は自由に入力できるほか、よく使われる金融商品（学資保険・NISA・リボ払いなど）の利率もプリセットで簡単に試せます。<br>
        本ツールはすべてブラウザ上で完結し、入力したデータは外部に送信されません。
    </footer>
</body>
</html>